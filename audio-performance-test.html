<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>éŸ³å£°ãªã— vs éŸ³å£°ã‚ã‚Šãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ¯”è¼ƒ</title>
  <style>
    body {
      font-family: 'Courier New', monospace;
      background: #1a1a1a;
      color: #ffffff;
      margin: 0;
      padding: 20px;
      min-height: 100vh;
    }
    
    .container {
      max-width: 1200px;
      margin: 0 auto;
    }
    
    .test-section {
      background: #2a2a2a;
      border: 1px solid #444;
      border-radius: 8px;
      padding: 20px;
      margin: 20px 0;
    }
    
    .typing-area {
      font-size: 1.4rem;
      line-height: 2;
      padding: 20px;
      background: #1e1e1e;
      border-radius: 4px;
      margin: 10px 0;
      min-height: 80px;
      font-family: 'Courier New', monospace;
    }
    
    .typing-char {
      display: inline-block;
      transition: none;
      padding: 2px;
      margin: 1px;
    }
    
    .typing-char.pending {
      color: #888;
      background: transparent;
    }
    
    .typing-char.current {
      color: #ffffff;
      background: #0066cc;
      border-radius: 3px;
      box-shadow: 0 0 8px rgba(0, 102, 204, 0.5);
    }
    
    .typing-char.completed {
      color: #4CAF50;
      background: rgba(76, 175, 80, 0.1);
    }
    
    .typing-char.error {
      color: #f44336;
      background: rgba(244, 67, 54, 0.2);
    }
    
    .performance-display {
      background: #0d1b2a;
      border: 1px solid #1b4f72;
      border-radius: 4px;
      padding: 15px;
      margin: 10px 0;
      font-family: monospace;
      font-size: 0.9rem;
    }
    
    .stats {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: 10px;
      margin: 10px 0;
    }
    
    .stat-item {
      background: #333;
      padding: 8px 12px;
      border-radius: 4px;
      text-align: center;
    }
    
    .stat-label {
      font-size: 0.7rem;
      color: #bbb;
      display: block;
    }
    
    .stat-value {
      font-size: 1.1rem;
      color: #fff;
      font-weight: bold;
    }
    
    .stat-value.good {
      color: #4CAF50;
    }
    
    .stat-value.warning {
      color: #ff9800;
    }
    
    .stat-value.bad {
      color: #f44336;
    }
    
    .controls {
      display: flex;
      gap: 10px;
      margin: 10px 0;
      flex-wrap: wrap;
    }
    
    button {
      background: #1976d2;
      color: white;
      border: none;
      padding: 10px 16px;
      border-radius: 4px;
      cursor: pointer;
      font-family: inherit;
      font-size: 0.9rem;
    }
    
    button:hover {
      background: #1565c0;
    }
    
    button:disabled {
      background: #555;
      cursor: not-allowed;
    }
    
    button.start {
      background: #4CAF50;
    }
    
    button.start:hover {
      background: #45a049;
    }
    
    button.reset {
      background: #ff9800;
    }
    
    button.reset:hover {
      background: #f57c00;
    }
    
    .comparison-result {
      background: #2d5016;
      border: 1px solid #4caf50;
      border-radius: 4px;
      padding: 20px;
      margin: 20px 0;
    }
    
    .warning {
      background: #5d4037;
      border: 1px solid #ff9800;
      color: #ffcc02;
      border-radius: 4px;
      padding: 15px;
      margin: 10px 0;
    }
    
    .word-display {
      font-size: 1.2rem;
      color: #64b5f6;
      margin: 10px 0;
      padding: 12px;
      background: #1e3a8a;
      border-radius: 4px;
      text-align: center;
    }
    
    .current-test {
      border: 2px solid #4CAF50;
      box-shadow: 0 0 15px rgba(76, 175, 80, 0.3);
    }
    
    .improvement {
      background: #1b5e20;
      border: 1px solid #4caf50;
      color: #a5d6a7;
      padding: 15px;
      border-radius: 4px;
      margin: 15px 0;
      font-size: 1.1rem;
      text-align: center;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>ğŸš€ éŸ³å£°å‡¦ç†ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ¯”è¼ƒãƒ†ã‚¹ãƒˆ</h1>
    <p>éŸ³å£°ãªã—ã‚¨ãƒ³ã‚¸ãƒ³ vs ç¾åœ¨ã®å®Ÿè£…ï¼ˆéŸ³å£°ã‚ã‚Šï¼‰ã®é€Ÿåº¦å·®ã‚’æ¸¬å®š</p>
    
    <!-- éŸ³å£°ãªã—ãƒ†ã‚¹ãƒˆ -->
    <div class="test-section" id="silent-section">
      <h2>ğŸ”‡ éŸ³å£°ãªã—é«˜é€Ÿã‚¨ãƒ³ã‚¸ãƒ³ (ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³)</h2>
      <div class="word-display" id="silent-word-display">æº–å‚™ä¸­...</div>
      <div class="typing-area" id="silent-typing-area"></div>
      <div class="performance-display" id="silent-performance">æ¸¬å®šå¾…æ©Ÿä¸­</div>
      <div class="controls">
        <button class="start" onclick="startSilentTest()">éŸ³å£°ãªã—ãƒ†ã‚¹ãƒˆé–‹å§‹</button>
        <button class="reset" onclick="resetSilentTest()">ãƒªã‚»ãƒƒãƒˆ</button>
        <button onclick="simulateSilentTyping()">è‡ªå‹•å…¥åŠ›ãƒ†ã‚¹ãƒˆ</button>
      </div>
    </div>
    
    <!-- éŸ³å£°ã‚ã‚Šãƒ†ã‚¹ãƒˆï¼ˆç¾åœ¨ã®å®Ÿè£…å‚ç…§ï¼‰ -->
    <div class="test-section" id="audio-section">
      <h2>ğŸ”Š éŸ³å£°ã‚ã‚Šå®Ÿè£… (ç¾åœ¨ã®å®Ÿè£…)</h2>
      <div class="warning">
        <strong>æ³¨æ„:</strong> ã“ã®ãƒ†ã‚¹ãƒˆã§ã¯ã€ç¾åœ¨ã®å®Ÿè£…ï¼ˆhttp://localhost:3001/gameï¼‰ã§ã®æ¸¬å®šçµæœã¨æ¯”è¼ƒã—ã¾ã™ã€‚<br>
        å®Ÿéš›ã®ãƒ†ã‚¹ãƒˆã¯åˆ¥ã‚¿ãƒ–ã§ã‚¿ã‚¤ãƒ”ãƒ³ã‚°ã‚²ãƒ¼ãƒ ã‚’å®Ÿè¡Œã—ã¦æ‰‹å‹•ã§æ¸¬å®šã—ã¦ãã ã•ã„ã€‚
      </div>
      <div class="controls">
        <button onclick="openCurrentImplementation()">ç¾åœ¨ã®å®Ÿè£…ã‚’é–‹ã</button>
        <button onclick="inputAudioResults()">éŸ³å£°ã‚ã‚Šçµæœã‚’å…¥åŠ›</button>
      </div>
    </div>
    
    <!-- æ¯”è¼ƒçµæœ -->
    <div class="test-section">
      <h2>ğŸ“Š ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ¯”è¼ƒçµæœ</h2>
      <div id="comparison-result" class="warning">
        ã¾ãšéŸ³å£°ãªã—ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„
      </div>
      <div class="controls">
        <button onclick="generateDetailedReport()">è©³ç´°ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ</button>
        <button onclick="exportComparisonResults()">çµæœã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ</button>
      </div>
    </div>
  </div>

  <script type="module">
    // éŸ³å£°ãªã—é«˜é€Ÿã‚¨ãƒ³ã‚¸ãƒ³ï¼ˆã‚¤ãƒ³ãƒ©ã‚¤ãƒ³å®Ÿè£…ï¼‰
    class SilentTypingEngine {
      constructor() {
        this.container = null;
        this.chars = [];
        this.currentIndex = 0;
        this.keyHandler = null;
        this.measurements = [];
        this.recording = false;
        this.setupKeyHandler();
      }

      setContainer(container) {
        this.container = container;
      }

      setWord(hiragana) {
        const romajiMap = {
          'ã“': 'ko', 'ã‚“': 'n', 'ã«': 'ni', 'ã¡': 'ti', 'ã¯': 'ha',
          'ã‚': 'a', 'ã‚Š': 'ri', 'ãŒ': 'ga', 'ã¨': 'to', 'ã†': 'u',
          'ãŠ': 'o', 'ã¤': 'tu', 'ã‹': 'ka', 'ã‚Œ': 're', 'ã•': 'sa', 'ã¾': 'ma',
          'ã°': 'ba', 'ã£': 'tta', 'ã¦': 'te', 'ã‚ˆ': 'yo', 'ã—': 'si', 'ã': 'ku'
        };

        this.chars = [];
        for (let char of hiragana) {
          if (romajiMap[char]) {
            this.chars.push({
              kana: char,
              romaji: romajiMap[char],
              inputted: '',
              completed: false
            });
          }
        }
        this.currentIndex = 0;
        this.render();
      }

      setupKeyHandler() {
        this.keyHandler = (e) => {
          if (e.key.length !== 1 || !/[a-z]/.test(e.key)) return;
          
          const startTime = performance.now();
          
          // ç´”ç²‹ãªã‚¿ã‚¤ãƒ”ãƒ³ã‚°å‡¦ç†ï¼ˆéŸ³å£°ãƒ»ã‚¨ãƒ•ã‚§ã‚¯ãƒˆãªã—ï¼‰
          const result = this.processKey(e.key);
          this.render();
          
          const endTime = performance.now();
          const latency = endTime - startTime;
          
          if (this.recording) {
            this.measurements.push(latency);
            this.updatePerformanceDisplay();
          }
          
          e.preventDefault();
        };

        document.addEventListener('keydown', this.keyHandler);
      }

      processKey(key) {
        if (this.currentIndex >= this.chars.length) return 'completed';

        const currentChar = this.chars[this.currentIndex];
        const expectedChar = currentChar.romaji[currentChar.inputted.length];

        if (key === expectedChar) {
          currentChar.inputted += key;
          if (currentChar.inputted === currentChar.romaji) {
            currentChar.completed = true;
            this.currentIndex++;
          }
          return 'correct';
        } else {
          return 'error';
        }
      }

      render() {
        if (!this.container) return;

        const html = this.chars.map((char, index) => {
          let displayChars = '';
          for (let i = 0; i < char.romaji.length; i++) {
            const romChar = char.romaji[i];
            let className = 'typing-char ';

            if (i < char.inputted.length) {
              className += 'completed';
            } else if (index === this.currentIndex && i === char.inputted.length) {
              className += 'current';
            } else {
              className += 'pending';
            }

            displayChars += `<span class="${className}">${romChar}</span>`;
          }
          return displayChars;
        }).join('');

        this.container.innerHTML = html;
      }

      updatePerformanceDisplay() {
        const stats = this.getStats();
        const element = document.getElementById('silent-performance');
        
        element.innerHTML = `
          <div class="stats">
            <div class="stat-item">
              <span class="stat-label">å¹³å‡é…å»¶</span>
              <span class="stat-value ${stats.avg <= 1 ? 'good' : stats.avg <= 3 ? 'warning' : 'bad'}">${stats.avg}ms</span>
            </div>
            <div class="stat-item">
              <span class="stat-label">æœ€å¤§é…å»¶</span>
              <span class="stat-value ${stats.max <= 2 ? 'good' : stats.max <= 5 ? 'warning' : 'bad'}">${stats.max}ms</span>
            </div>
            <div class="stat-item">
              <span class="stat-label">æœ€å°é…å»¶</span>
              <span class="stat-value">${stats.min}ms</span>
            </div>
            <div class="stat-item">
              <span class="stat-label">æ¸¬å®šå›æ•°</span>
              <span class="stat-value">${stats.count}</span>
            </div>
            <div class="stat-item">
              <span class="stat-label">ç†æƒ³çš„æ€§èƒ½</span>
              <span class="stat-value ${stats.ideal ? 'good' : 'warning'}">${stats.ideal ? 'âœ… ç†æƒ³çš„' : 'âš ï¸ æ”¹å–„ä½™åœ°ã‚ã‚Š'}</span>
            </div>
          </div>
        `;
      }

      startRecording() {
        this.measurements = [];
        this.recording = true;
        console.log('ğŸ¯ éŸ³å£°ãªã—ã‚¿ã‚¤ãƒ”ãƒ³ã‚°æ¸¬å®šé–‹å§‹');
      }

      stopRecording() {
        this.recording = false;
        return this.getStats();
      }

      getStats() {
        if (this.measurements.length === 0) {
          return { count: 0, avg: 0, min: 0, max: 0, ideal: false };
        }

        const avg = this.measurements.reduce((a, b) => a + b, 0) / this.measurements.length;
        const min = Math.min(...this.measurements);
        const max = Math.max(...this.measurements);
        // éŸ³å£°ãªã—ãªã®ã§ã€ã‚ˆã‚Šå³ã—ã„åŸºæº–ï¼ˆå¹³å‡1msä»¥ä¸‹ã€æœ€å¤§2msä»¥ä¸‹ï¼‰
        const ideal = avg <= 1 && max <= 2;

        return {
          count: this.measurements.length,
          avg: parseFloat(avg.toFixed(3)),
          min: parseFloat(min.toFixed(3)),
          max: parseFloat(max.toFixed(3)),
          ideal,
          measurements: [...this.measurements]
        };
      }

      isCompleted() {
        return this.currentIndex >= this.chars.length;
      }

      destroy() {
        if (this.keyHandler) {
          document.removeEventListener('keydown', this.keyHandler);
          this.keyHandler = null;
        }
      }

      reset() {
        this.currentIndex = 0;
        this.chars.forEach(char => {
          char.inputted = '';
          char.completed = false;
        });
        this.render();
      }
    }

    // ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°
    let silentEngine = null;
    let silentResults = null;
    let audioResults = null;

    // ãƒ†ã‚¹ãƒˆåˆ¶å¾¡é–¢æ•°
    window.startSilentTest = function() {
      if (silentEngine) {
        silentEngine.destroy();
      }

      const container = document.getElementById('silent-typing-area');
      silentEngine = new SilentTypingEngine();
      silentEngine.setContainer(container);
      silentEngine.startRecording();

      document.getElementById('silent-word-display').textContent = 'ä»Šæ—¥ã¯ (ã“ã‚“ã«ã¡ã¯)';
      silentEngine.setWord('ã“ã‚“ã«ã¡ã¯');
      
      document.getElementById('silent-performance').innerHTML = '<p>ğŸ“Š æ¸¬å®šä¸­... ã‚¿ã‚¤ãƒ”ãƒ³ã‚°ã‚’é–‹å§‹ã—ã¦ãã ã•ã„ï¼ˆéŸ³å£°ãªã—ï¼‰</p>';
      
      // ç¾åœ¨ã®ãƒ†ã‚¹ãƒˆã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’ãƒã‚¤ãƒ©ã‚¤ãƒˆ
      document.getElementById('silent-section').classList.add('current-test');
      document.getElementById('audio-section').classList.remove('current-test');
    };

    window.resetSilentTest = function() {
      if (silentEngine) {
        silentEngine.destroy();
        silentEngine = null;
      }
      document.getElementById('silent-typing-area').innerHTML = '';
      document.getElementById('silent-performance').innerHTML = 'æ¸¬å®šå¾…æ©Ÿä¸­';
      document.getElementById('silent-word-display').textContent = 'æº–å‚™ä¸­...';
      document.getElementById('silent-section').classList.remove('current-test');
    };

    window.simulateSilentTyping = function() {
      if (!silentEngine) {
        startSilentTest();
        setTimeout(simulateSilentTyping, 100);
        return;
      }

      const keys = ['k', 'o', 'n', 'n', 'i', 't', 'i', 'h', 'a'];
      let keyIndex = 0;

      const simulate = () => {
        if (keyIndex >= keys.length || silentEngine.isCompleted()) {
          setTimeout(() => {
            silentResults = silentEngine.stopRecording();
            showSilentResults(silentResults);
          }, 500);
          return;
        }

        const key = keys[keyIndex];
        const event = new KeyboardEvent('keydown', {
          key: key,
          bubbles: true,
          cancelable: true
        });

        document.dispatchEvent(event);
        keyIndex++;

        setTimeout(simulate, 30 + Math.random() * 70); // 30-100msã®é–“éš”
      };

      setTimeout(simulate, 300);
    };

    function showSilentResults(results) {
      console.log('ğŸ”‡ éŸ³å£°ãªã—ã‚¨ãƒ³ã‚¸ãƒ³çµæœ:', results);
      
      if (audioResults) {
        showComparison();
      } else {
        document.getElementById('comparison-result').innerHTML = `
          <h3>ğŸ”‡ éŸ³å£°ãªã—çµæœ (ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³)</h3>
          <p><strong>å¹³å‡é…å»¶:</strong> ${results.avg}ms</p>
          <p><strong>æœ€å¤§é…å»¶:</strong> ${results.max}ms</p>
          <p><strong>æœ€å°é…å»¶:</strong> ${results.min}ms</p>
          <p><strong>æ¸¬å®šå›æ•°:</strong> ${results.count}å›</p>
          <p>æ¬¡ã«ã€ç¾åœ¨ã®å®Ÿè£…ï¼ˆéŸ³å£°ã‚ã‚Šï¼‰ã§ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚</p>
        `;
      }
    }

    window.openCurrentImplementation = function() {
      window.open('http://localhost:3001/game', '_blank');
      alert('æ–°ã—ã„ã‚¿ãƒ–ã§ç¾åœ¨ã®å®Ÿè£…ãŒé–‹ãã¾ã™ã€‚\n\nã‚¿ã‚¤ãƒ”ãƒ³ã‚°ã‚’å®Ÿè¡Œã—ã¦ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹çµæœã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚\n\nçµæœãŒå¾—ã‚‰ã‚ŒãŸã‚‰ã€ŒéŸ³å£°ã‚ã‚Šçµæœã‚’å…¥åŠ›ã€ãƒœã‚¿ãƒ³ã§å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚');
    };

    window.inputAudioResults = function() {
      const avgInput = prompt('éŸ³å£°ã‚ã‚Šã®å¹³å‡é…å»¶ (ms) ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„:');
      const maxInput = prompt('éŸ³å£°ã‚ã‚Šã®æœ€å¤§é…å»¶ (ms) ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„:');
      const countInput = prompt('éŸ³å£°ã‚ã‚Šã®æ¸¬å®šå›æ•°ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„:');

      if (avgInput && maxInput && countInput) {
        audioResults = {
          avg: parseFloat(avgInput),
          max: parseFloat(maxInput),
          count: parseInt(countInput),
          typingmaniaRefLevel: parseFloat(avgInput) <= 5 && parseFloat(maxInput) <= 10
        };

        console.log('ğŸ”Š éŸ³å£°ã‚ã‚Šçµæœï¼ˆæ‰‹å‹•å…¥åŠ›ï¼‰:', audioResults);

        if (silentResults) {
          showComparison();
        } else {
          alert('å…ˆã«éŸ³å£°ãªã—ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚');
        }
      }
    };

    function showComparison() {
      if (!silentResults || !audioResults) return;

      const improvement = ((audioResults.avg - silentResults.avg) / audioResults.avg * 100);
      const maxImprovement = ((audioResults.max - silentResults.max) / audioResults.max * 100);

      let resultClass = 'comparison-result';
      let recommendation = '';

      if (improvement > 50) {
        recommendation = 'ğŸš€ éŸ³å£°å‡¦ç†ãŒå¤§å¹…ãªé…å»¶ã‚’å¼•ãèµ·ã“ã—ã¦ã„ã¾ã™ã€‚éŸ³å£°ã‚·ã‚¹ãƒ†ãƒ ã®æœ€é©åŒ–ã¾ãŸã¯ç„¡åŠ¹åŒ–ã‚’å¼·ãæ¨å¥¨ã—ã¾ã™ã€‚';
      } else if (improvement > 20) {
        recommendation = 'âš ï¸ éŸ³å£°å‡¦ç†ã«ã‚ˆã‚‹é…å»¶ãŒç¢ºèªã•ã‚Œã¾ã—ãŸã€‚æœ€é©åŒ–ã‚’æ¤œè¨ã—ã¦ãã ã•ã„ã€‚';
      } else if (improvement > 0) {
        recommendation = 'ğŸ“Š è»½å¾®ãªé…å»¶ãŒéŸ³å£°å‡¦ç†ã§ç™ºç”Ÿã—ã¦ã„ã¾ã™ãŒã€è¨±å®¹ç¯„å›²å†…ã§ã™ã€‚';
      } else {
        recommendation = 'âœ… éŸ³å£°å‡¦ç†ã«ã‚ˆã‚‹é…å»¶ã¯æ¤œå‡ºã•ã‚Œã¾ã›ã‚“ã§ã—ãŸã€‚';
      }

      document.getElementById('comparison-result').className = resultClass;
      document.getElementById('comparison-result').innerHTML = `
        <h3>ğŸ“Š ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ¯”è¼ƒçµæœ</h3>
        <div class="stats">
          <div class="stat-item">
            <span class="stat-label">éŸ³å£°ãªã—å¹³å‡</span>
            <span class="stat-value good">${silentResults.avg}ms</span>
          </div>
          <div class="stat-item">
            <span class="stat-label">éŸ³å£°ã‚ã‚Šå¹³å‡</span>
            <span class="stat-value ${audioResults.typingmaniaRefLevel ? 'warning' : 'bad'}">${audioResults.avg}ms</span>
          </div>
          <div class="stat-item">
            <span class="stat-label">å¹³å‡é…å»¶æ”¹å–„</span>
            <span class="stat-value ${improvement > 20 ? 'good' : 'warning'}">${improvement.toFixed(1)}%</span>
          </div>
          <div class="stat-item">
            <span class="stat-label">æœ€å¤§é…å»¶æ”¹å–„</span>
            <span class="stat-value ${maxImprovement > 20 ? 'good' : 'warning'}">${maxImprovement.toFixed(1)}%</span>
          </div>
        </div>
        <div class="improvement">
          ${recommendation}
        </div>
        <p><strong>çµè«–:</strong> éŸ³å£°å‡¦ç†ã‚’å‰Šé™¤ã™ã‚‹ã“ã¨ã§å¹³å‡ ${improvement.toFixed(1)}% ã®é€Ÿåº¦å‘ä¸ŠãŒæœŸå¾…ã§ãã¾ã™ã€‚</p>
      `;
    }

    window.generateDetailedReport = function() {
      const report = {
        timestamp: new Date().toISOString(),
        test: 'Audio Performance Impact Analysis',
        silent: silentResults,
        audio: audioResults,
        environment: {
          userAgent: navigator.userAgent,
          platform: navigator.platform,
          hardwareConcurrency: navigator.hardwareConcurrency
        }
      };

      console.log('ğŸ“‹ è©³ç´°ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ¯”è¼ƒãƒ¬ãƒãƒ¼ãƒˆ:', report);
      alert('è©³ç´°ãƒ¬ãƒãƒ¼ãƒˆãŒã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«å‡ºåŠ›ã•ã‚Œã¾ã—ãŸ');
    };

    window.exportComparisonResults = function() {
      const data = {
        testType: 'Audio Performance Impact Test',
        timestamp: new Date().toISOString(),
        results: {
          silent: silentResults,
          audio: audioResults
        }
      };

      const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'audio-performance-comparison.json';
      a.click();
      URL.revokeObjectURL(url);
    };

    // åˆæœŸåŒ–
    window.addEventListener('load', () => {
      console.log('ğŸš€ éŸ³å£°ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ¯”è¼ƒãƒ†ã‚¹ãƒˆæº–å‚™å®Œäº†');
      document.getElementById('silent-word-display').textContent = 'ãƒ†ã‚¹ãƒˆé–‹å§‹ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ãã ã•ã„';
    });
  </script>
</body>
</html>
