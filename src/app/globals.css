/* =====================================
   PROFESSIONAL GAMING UI DESIGN SYSTEM
   monkeytype Minimalism × THE FINALS Cyberpunk
   ===================================== */

/* フォントインポート - プロゲーミング向け */
@import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600;700&display=swap');
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
@import "../styles/reset.css";
@import "../styles/preserved-elements.css";

/* =====================================
   CSS CUSTOM PROPERTIES (DESIGN TOKENS)
   ===================================== */
:root {
  /* カラーパレット - モダンミニマル */
  --color-base-black: #141414;
  --color-base-dark: #1e1e1e;
  --color-base-medium: #2a2a2a;
  --color-accent-cyan: #8ab4f8;
  --color-accent-neon: #e8b84a;
  --color-accent-purple: #9bb0c1;
  --color-success: #81c784;
  --color-error: #f28b82;
  --color-warning: #fdd663;
  --color-text-primary: #e8eaed;
  --color-text-secondary: #bdc1c6;
  --color-text-muted: #9aa0a6;

  /* グラデーション */
  --gradient-cyber: linear-gradient(135deg, var(--color-accent-cyan), var(--color-accent-purple));
  --gradient-neon: linear-gradient(90deg, var(--color-accent-neon), var(--color-accent-cyan));
  --gradient-dark: linear-gradient(180deg, var(--color-base-black), var(--color-base-dark));

  /* シャドウ - ソフトグロー */
  --glow-cyan: 0 0 8px rgba(138, 180, 248, 0.3), 0 0 16px rgba(138, 180, 248, 0.2);
  --glow-neon: 0 0 8px rgba(232, 184, 74, 0.3), 0 0 16px rgba(232, 184, 74, 0.2);
  --glow-purple: 0 0 8px rgba(155, 176, 193, 0.3), 0 0 16px rgba(155, 176, 193, 0.2);
  --glow-error: 0 0 8px rgba(242, 139, 130, 0.3), 0 0 16px rgba(242, 139, 130, 0.2);

  /* タイポグラフィ */
  --font-mono: 'JetBrains Mono', 'Courier New', monospace;
  --font-ui: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
  
  /* スペーシング */
  --space-xs: 0.25rem;
  --space-sm: 0.5rem;
  --space-md: 1rem;
  --space-lg: 1.5rem;
  --space-xl: 2rem;
  --space-2xl: 3rem;

  /* アニメーション */
  --transition-fast: 0.15s cubic-bezier(0.4, 0, 0.2, 1);
  --transition-normal: 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  --transition-slow: 0.5s cubic-bezier(0.4, 0, 0.2, 1);
  --easing-bounce: cubic-bezier(0.68, -0.55, 0.265, 1.55);
  --easing-smooth: cubic-bezier(0.25, 0.1, 0.25, 1);

  /* レイアウト */
  --header-height: 60px;
  --sidebar-width: 250px;
  --border-radius: 8px;
  --border-radius-lg: 12px;

  /* パフォーマンス最適化設定 - typingmania-ref流 */
  --performance-enable-gpu: true;
  --performance-layer-force: translateZ(0);
  --performance-will-change: transform, opacity, background-color;
  --performance-contain: layout style paint;
  --performance-content-visibility: auto;
}

/* ダークモード対応 */
@media (prefers-color-scheme: dark) {
  :root {
    color-scheme: dark;
  }
}

/* アクセシビリティ - アニメーション削減 */
@media (prefers-reduced-motion: reduce) {
  *, *::before, *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
}

/* =====================================
   BASE STYLES & RESET
   ===================================== */
*, *::before, *::after {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

html {
  font-size: 16px;
  scroll-behavior: smooth;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  text-rendering: optimizeLegibility;
  overflow: hidden;
  height: 100%;
}

body {
  background: var(--color-base-black);
  color: var(--color-text-secondary);
  font-family: var(--font-mono);
  font-variant-numeric: tabular-nums;
  height: 100vh;
  width: 100vw;
  position: relative;
  /* 保持: 既存のflexレイアウト */
  display: flex;
  flex-direction: column;
  justify-content: flex-start;
  align-items: stretch;
  overflow: hidden;
  /* パフォーマンス最適化 */
  will-change: transform;
  transform: translate3d(0, 0, 0);
  /* 動的背景システム */
  background-image: 
    radial-gradient(circle at 20% 50%, rgba(138, 180, 248, 0.05) 0%, transparent 50%),
    radial-gradient(circle at 80% 20%, rgba(155, 176, 193, 0.05) 0%, transparent 50%),
    radial-gradient(circle at 40% 80%, rgba(232, 184, 74, 0.03) 0%, transparent 50%);
  background-attachment: fixed;
  background-size: 100% 100%;
}

/* 動的パーティクル背景（CSS-only） */
body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: -2;
  background-image: 
    repeating-linear-gradient(
      0deg,
      transparent,
      transparent 98px,
      rgba(138, 180, 248, 0.015) 100px
    ),
    repeating-linear-gradient(
      90deg,
      transparent,
      transparent 98px,
      rgba(138, 180, 248, 0.015) 100px
    );
  animation: gridMove 20s linear infinite;
  pointer-events: none;
}

/* グリッドアニメーション */
@keyframes gridMove {
  0% { transform: translate(0, 0); }
  100% { transform: translate(100px, 100px); }
}

/* パララックスレイヤー */
body::after {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  width: 120%;
  height: 120%;
  z-index: -1;
  background: 
    radial-gradient(2px 2px at 20px 30px, rgba(138, 180, 248, 0.15), transparent),
    radial-gradient(2px 2px at 40px 70px, rgba(232, 184, 74, 0.1), transparent),
    radial-gradient(1px 1px at 90px 40px, rgba(155, 176, 193, 0.15), transparent);
  background-size: 200px 200px;
  animation: float 30s ease-in-out infinite;
  pointer-events: none;
}

@keyframes float {
  0%, 100% { transform: translate(-10px, -10px) rotate(0deg); }
  50% { transform: translate(10px, 10px) rotate(180deg); }
}

#root, #__next {
  height: 100%;
  min-height: 100vh;
  display: flex;
  flex-direction: column;
  overflow: hidden;
}

main, .main, .appMain, .centerPanel {
  flex: 1 0 auto;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  min-height: 0;
  min-width: 0;
  width: 100vw;
  height: 100vh;
  max-width: 100vw;
  max-height: 100vh;
  box-sizing: border-box;
  position: relative;
  z-index: 1;
  overflow: hidden;
}

header {
  z-index: 10000;
}

/* =====================================
   HEADER STYLES - ORIGINAL FONT
   ===================================== */
.header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  position: fixed;
  top: 15px; /* 20px → 15px により上部に */
  left: 15px; /* 20px → 15px により左に */
  z-index: 10000;
  width: calc(100% - 30px); /* 40px → 30px に調整 */
  background: transparent; /* 透過で背景を完全に消す */
  box-shadow: none;
  border: none;
  padding: 0;
  margin: 0;
  border-radius: 8px;
  backdrop-filter: blur(5px); /* 背景ぼかしは維持 */
}

.logo-container {
  display: flex;
  align-items: center;
  gap: 10px;
}

.logo-image {
  display: block;
}

.logo-text-container {
  display: flex;
}

.logo-text {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  font-weight: bold;
  font-size: 28px;
  color: #d1d0c5;
  text-shadow: 0 0 2px rgba(0, 0, 0, 0.5);
}

/* アイコングループ */
.icon-group {
  display: flex;
  align-items: center;
  gap: 12px;
}

/* ヘッダーアイコンボタン */
.header-icon-btn {
  background: none;
  border: none;
  cursor: pointer;
  padding: 8px;
  border-radius: 6px;
  transition: all 0.2s ease;
  display: flex;
  align-items: center;
  justify-content: center;
}

.header-icon-btn:hover {
  background: rgba(138, 180, 248, 0.1);
  transform: translateY(-1px);
}

/* ヘッダーアイコン */
.header-icon {
  width: 24px;
  height: 24px;
  color: #d1d0c5;
  transition: all 0.2s ease;
}

.header-icon-btn:hover .header-icon {
  color: var(--color-accent-cyan);
  filter: drop-shadow(0 0 4px rgba(138, 180, 248, 0.6));
}

/* =====================================
   TYPOGRAPHY SYSTEM
   ===================================== */
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-ui);
  font-weight: 600;
  line-height: 1.2;
  color: var(--color-text-primary);
  margin-bottom: var(--space-md);
}

h1 { font-size: 2.5rem; }
h2 { font-size: 2rem; }
h3 { font-size: 1.5rem; }
h4 { font-size: 1.25rem; }
h5 { font-size: 1.125rem; }
h6 { font-size: 1rem; }

p, span, div {
  line-height: 1.6;
  color: var(--color-text-secondary);
}

.text-mono {
  font-family: var(--font-mono);
  font-variant-numeric: tabular-nums;
}

.text-glow {
  text-shadow: var(--glow-cyan);
  color: var(--color-accent-cyan);
}

.text-neon {
  text-shadow: var(--glow-neon);
  color: var(--color-accent-neon);
}

/* =====================================
   BUTTON SYSTEM
   ===================================== */
button, .btn {
  font-family: var(--font-ui);
  font-weight: 500;
  border: none;
  border-radius: var(--border-radius);
  cursor: pointer;
  transition: all var(--transition-fast);
  position: relative;
  overflow: hidden;
  background: transparent;
  color: var(--color-text-primary);
  padding: var(--space-sm) var(--space-lg);
  font-size: 0.95rem;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  will-change: transform, box-shadow;
  transform: translate3d(0, 0, 0);
}

/* プライマリボタン */
.btn-primary {
  background: var(--gradient-cyber);
  box-shadow: var(--glow-cyan);
  border: 1px solid var(--color-accent-cyan);
}

.btn-primary:hover {
  transform: scale(1.05) translate3d(0, -2px, 0);
  box-shadow: var(--glow-cyan), 0 8px 25px rgba(138, 180, 248, 0.2);
  filter: brightness(1.2);
}

.btn-primary:active {
  transform: scale(0.98) translate3d(0, 0, 0);
  box-shadow: var(--glow-cyan);
}

/* セカンダリボタン */
.btn-secondary {
  background: transparent;
  border: 1px solid var(--color-accent-purple);
  color: var(--color-accent-purple);
}

.btn-secondary:hover {
  background: var(--color-accent-purple);
  color: var(--color-base-black);
  box-shadow: var(--glow-purple);
  transform: scale(1.05) translate3d(0, -2px, 0);
}

/* グリッチエフェクト */
.btn-glitch:hover::before {
  content: attr(data-text);
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: inherit;
  color: var(--color-error);
  animation: glitch 0.3s infinite;
  pointer-events: none;
}

@keyframes glitch {
  0% { transform: translate(0); }
  20% { transform: translate(-2px, 2px); }
  40% { transform: translate(-2px, -2px); }
  60% { transform: translate(2px, 2px); }
  80% { transform: translate(2px, -2px); }
  100% { transform: translate(0); }
}

/* 無効状態 */
button:disabled, .btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none !important;
  box-shadow: none !important;
  filter: grayscale(1);
}

/* =====================================
   TYPING AREA SYSTEM
   ===================================== */
.typing-area {
  background: rgba(26, 26, 26, 0.8);
  border: 2px solid var(--color-accent-cyan);
  border-radius: var(--border-radius-lg);
  padding: var(--space-xl);
  box-shadow: var(--glow-cyan), inset 0 0 20px rgba(0, 245, 255, 0.1);
  backdrop-filter: blur(10px);
  position: relative;
  overflow: hidden;
}

.typing-area::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(138, 180, 248, 0.05), transparent);
  animation: scan 3s infinite;
}

@keyframes scan {
  0% { left: -100%; }
  100% { left: 100%; }
}

.typing-text {
  font-family: var(--font-mono);
  font-size: 1.5rem;
  line-height: 1.8;
  color: var(--color-text-secondary);
  user-select: none;
  position: relative;
  z-index: 2;
}

.typing-cursor {
  background: var(--color-accent-neon);
  width: 3px;
  height: 1.5rem;
  display: inline-block;
  animation: blink 1s infinite, glow 2s ease-in-out infinite alternate;
  box-shadow: var(--glow-neon);
  margin-left: 2px;
  position: relative;
  top: 2px;
}

@keyframes blink {
  0%, 50% { opacity: 1; }
  51%, 100% { opacity: 0; }
}

@keyframes glow {
  0% { box-shadow: var(--glow-neon); }
  100% { box-shadow: 0 0 12px rgba(232, 184, 74, 0.4), 0 0 24px rgba(232, 184, 74, 0.3); }
}

/* 文字状態 */
.char-correct {
  color: var(--color-success);
  text-shadow: var(--glow-neon);
  animation: correct 0.2s ease-out;
}

.char-incorrect {
  color: var(--color-error);
  text-shadow: var(--glow-error);
  background: rgba(242, 139, 130, 0.2);
  animation: error 0.3s ease-out, shake 0.3s ease-out;
}

@keyframes correct {
  0% { transform: scale(1); }
  50% { transform: scale(1.1); }
  100% { transform: scale(1); }
}

@keyframes error {
  0% { background: rgba(242, 139, 130, 0.5); }
  100% { background: rgba(242, 139, 130, 0.2); }
}

@keyframes shake {
  0%, 100% { transform: translateX(0); }
  25% { transform: translateX(-2px); }
  75% { transform: translateX(2px); }
}

/* =====================================
   INTERACTIVE ELEMENTS
   ===================================== */
input, textarea {
  background: rgba(26, 26, 26, 0.9);
  border: 1px solid var(--color-base-medium);
  border-radius: var(--border-radius);
  color: var(--color-text-primary);
  font-family: var(--font-mono);
  padding: var(--space-sm) var(--space-md);
  transition: all var(--transition-normal);
  outline: none;
}

input:focus, textarea:focus {
  border-color: var(--color-accent-cyan);
  box-shadow: var(--glow-cyan);
  background: rgba(26, 26, 26, 1);
}

/* =====================================
   SCORE & STATS DISPLAY
   ===================================== */
.stats-container {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
  gap: var(--space-lg);
  padding: var(--space-lg);
  background: rgba(26, 26, 26, 0.6);
  border-radius: var(--border-radius-lg);
  border: 1px solid var(--color-base-medium);
}

.stat-item {
  text-align: center;
  padding: var(--space-md);
  border-radius: var(--border-radius);
  background: rgba(42, 42, 42, 0.5);
  transition: all var(--transition-normal);
}

.stat-item:hover {
  background: rgba(42, 42, 42, 0.8);
  transform: translateY(-2px);
  box-shadow: 0 4px 20px rgba(0, 245, 255, 0.2);
}

.stat-value {
  font-size: 2rem;
  font-weight: 700;
  color: var(--color-accent-cyan);
  font-family: var(--font-mono);
  text-shadow: var(--glow-cyan);
  margin-bottom: var(--space-xs);
  animation: countUp 0.8s var(--easing-bounce);
}

@keyframes countUp {
  0% { transform: scale(0) rotate(180deg); opacity: 0; }
  100% { transform: scale(1) rotate(0deg); opacity: 1; }
}

.stat-label {
  font-size: 0.85rem;
  color: var(--color-text-muted);
  text-transform: uppercase;
  letter-spacing: 0.05em;
  font-family: var(--font-ui);
}

/* =====================================
   SCROLLBAR STYLING
   ===================================== */
::-webkit-scrollbar {
  width: 8px;
  height: 8px;
}

::-webkit-scrollbar-track {
  background: var(--color-base-dark);
  border-radius: var(--border-radius);
}

::-webkit-scrollbar-thumb {
  background: var(--gradient-cyber);
  border-radius: var(--border-radius);
  box-shadow: var(--glow-cyan);
}

::-webkit-scrollbar-thumb:hover {
  background: var(--color-accent-cyan);
  box-shadow: var(--glow-cyan), 0 0 10px var(--color-accent-cyan);
}

/* =====================================
   RESPONSIVE DESIGN
   ===================================== */
@container (max-width: 768px) {
  .typing-text { font-size: 1.2rem; }
  .stats-container { grid-template-columns: repeat(2, 1fr); }
  .stat-value { font-size: 1.5rem; }
  h1 { font-size: 2rem; }
  h2 { font-size: 1.5rem; }
}

@container (max-width: 480px) {
  .typing-text { font-size: 1rem; }
  .stats-container { grid-template-columns: 1fr; }
  .typing-area { padding: var(--space-lg); }
}

/* 4K対応 */
@media (min-width: 2560px) {
  html { font-size: 20px; }
  .typing-text { font-size: 1.8rem; }
}

/* =====================================
   UTILITY CLASSES
   ===================================== */
.glow-on-hover:hover {
  box-shadow: var(--glow-cyan);
  transform: translateY(-2px);
}

.fade-in {
  animation: fadeIn 0.6s var(--easing-smooth);
}

@keyframes fadeIn {
  0% { opacity: 0; transform: translateY(20px); }
  100% { opacity: 1; transform: translateY(0); }
}

.slide-up {
  animation: slideUp 0.4s var(--easing-smooth);
}

@keyframes slideUp {
  0% { transform: translateY(100%); opacity: 0; }
  100% { transform: translateY(0); opacity: 1; }
}

.cyber-border {
  border: 1px solid var(--color-accent-cyan);
  box-shadow: var(--glow-cyan);
  position: relative;
}

.cyber-border::before {
  content: '';
  position: absolute;
  top: -1px;
  left: -1px;
  right: -1px;
  bottom: -1px;
  background: var(--gradient-cyber);
  border-radius: inherit;
  z-index: -1;
  opacity: 0;
  transition: opacity var(--transition-normal);
}

.cyber-border:hover::before {
  opacity: 1;
}

/* GPU加速クラス */
.gpu-accelerated {
  will-change: transform;
  transform: translate3d(0, 0, 0);
}

/* =====================================
   HIGH CONTRAST MODE
   ===================================== */
@media (prefers-contrast: high) {
  :root {
    --color-text-primary: #ffffff;
    --color-text-secondary: #ffffff;
    --color-base-black: #000000;
    --color-base-dark: #000000;
  }
}

/* =====================================
   GAME SCREEN SYSTEM
   ===================================== */
.game-screen {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: flex-start;
  width: 100%;
  height: 100vh;
  padding: 6vh var(--space-xl); /* 8vh → 6vh でコンテンツを少し上に */
  position: relative;
  overflow: hidden;
}

.word-japanese {
  font-size: 3rem;
  font-weight: 700;
  color: var(--color-text-primary);
  font-family: var(--font-ui);
  text-align: center;
  margin-bottom: var(--space-lg);
  text-shadow: var(--glow-cyan);
  letter-spacing: 0.02em;
  animation: fadeIn 0.6s var(--easing-smooth);
}

.word-hiragana {
  font-size: 1.5rem;
  font-weight: 500;
  color: var(--color-text-muted);
  font-family: var(--font-mono);
  text-align: center;
  margin-bottom: var(--space-2xl);
  opacity: 0.8;
  letter-spacing: 0.1em;
  animation: fadeIn 0.6s var(--easing-smooth) 0.15s both;
}

/* =====================================
   TYPING CHARACTER SYSTEM
   ===================================== */
.typing-char {
  font-family: var(--font-mono);
  font-size: 1.5rem;
  line-height: 1.8;
  transition: all var(--transition-fast);
  position: relative;
  display: inline-block;
}

.char-completed {
  color: var(--color-success);
  text-shadow: var(--glow-neon);
}

.char-pending {
  color: var(--color-text-secondary);
  opacity: 0.6;
}

.char-incorrect {
  color: var(--color-error);
  background: rgba(242, 139, 130, 0.2);
  text-shadow: var(--glow-error);
  animation: shake 0.3s ease-out;
}

/* =====================================
   RESULT SCREEN SYSTEM
   ===================================== */
.result-screen {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  width: 100%;
  height: 100vh;
  padding: var(--space-xl);
  background: var(--gradient-dark);
  position: relative;
  overflow: hidden;
}

.result-title {
  font-size: 2.5rem;
  font-weight: 700;
  color: var(--color-accent-cyan);
  font-family: var(--font-ui);
  text-align: center;
  margin-bottom: var(--space-xl);
  text-shadow: var(--glow-cyan);
  text-transform: uppercase;
  letter-spacing: 0.05em;
}

.stats-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: var(--space-lg);
  width: 100%;
  max-width: 800px;
  margin-bottom: var(--space-xl);
}

.stat-card {
  background: rgba(26, 26, 26, 0.8);
  border: 1px solid var(--color-base-medium);
  border-radius: var(--border-radius-lg);
  padding: var(--space-lg);
  text-align: center;
  transition: all var(--transition-normal);
  backdrop-filter: blur(10px);
}

.stat-card:hover {
  background: rgba(42, 42, 42, 0.8);
  border-color: var(--color-accent-cyan);
  box-shadow: var(--glow-cyan);
  transform: translateY(-4px);
}

.count-up-number {
  display: inline-block;
  animation: countUp 0.8s var(--easing-bounce);
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

.calculating-container {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: var(--space-md);
}

.calculating-text {
  font-size: 1.2rem;
  color: var(--color-text-muted);
  font-family: var(--font-mono);
  animation: pulse 1.5s infinite;
}

.performance-message {
  text-align: center;
  margin-bottom: var(--space-lg);
  font-size: 1.25rem;
  font-family: var(--font-ui);
}

.message-highlight {
  color: var(--color-accent-neon);
  font-weight: 600;
  text-shadow: var(--glow-neon);
}

.result-actions {
  display: flex;
  gap: var(--space-md);
  flex-wrap: wrap;
  justify-content: center;
}

.registered-text {
  color: var(--color-success);
  font-size: 0.9rem;
  font-family: var(--font-mono);
  text-shadow: var(--glow-neon);
}

/* =====================================
   RANKING SCREEN SYSTEM
   ===================================== */
.ranking-screen {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: flex-start;
  min-height: 100vh;
  width: 100vw;
  padding-top: 8vh;
  box-sizing: border-box;
}

.ranking-container {
  width: 100%;
  max-width: 700px;
  background: rgba(26, 26, 26, 0.85);
  border-radius: var(--border-radius-lg);
  box-shadow: 0 4px 32px rgba(138, 180, 248, 0.06);
  padding: var(--space-2xl) var(--space-xl);
  margin: 0 auto;
  display: flex;
  flex-direction: column;
  align-items: center;
}

.ranking-header {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  width: 100%;
  margin-bottom: var(--space-xl);
}

.ranking-title {
  font-size: 2.5rem;
  font-family: var(--font-ui);
  font-weight: 700;
  color: var(--color-accent-cyan);
  letter-spacing: 0.1em;
  margin-bottom: var(--space-xs);
  text-shadow: var(--glow-cyan);
  text-align: center;
  width: 100%;
}

.ranking-subtitle {
  font-size: 1.1rem;
  color: var(--color-text-muted);
  font-family: var(--font-ui);
  margin-bottom: var(--space-md);
}

.difficulty-selector {
  display: flex;
  gap: var(--space-md);
  margin-bottom: var(--space-xl);
}

.ranking-table-container {
  width: 100%;
  overflow-x: auto;
}

.ranking-table {
  width: 100%;
  border-collapse: separate;
  border-spacing: 0;
  background: rgba(20, 20, 20, 0.95);
  border-radius: var(--border-radius-lg);
  box-shadow: 0 2px 16px rgba(138, 180, 248, 0.04);
  overflow: hidden;
  margin-bottom: var(--space-xl);
}

.table-header {
  background: var(--gradient-cyber);
}

.table-header-cell {
  font-family: var(--font-ui);
  font-size: 1.1rem;
  font-weight: 600;
  color: var(--color-accent-cyan);
  padding: var(--space-md) var(--space-sm);
  text-align: center;
  border-bottom: 2px solid var(--color-accent-cyan);
  letter-spacing: 0.05em;
}

.ranking-table tbody tr {
  transition: background 0.2s;
}

.ranking-table tbody tr:nth-child(even) {
  background: rgba(138, 180, 248, 0.03);
}

.ranking-table tbody tr:hover {
  background: rgba(138, 180, 248, 0.08);
}

.ranking-table td {
  font-family: var(--font-mono);
  font-size: 1rem;
  color: var(--color-text-primary);
  padding: var(--space-md) var(--space-sm);
  text-align: center;
  border-bottom: 1px solid rgba(138, 180, 248, 0.06);
}

.loading-state, .error-state, .empty-state {
  text-align: center;
  padding: var(--space-xl) 0;
  color: var(--color-text-muted);
}

.loading-spinner {
  width: 32px;
  height: 32px;
  border: 4px solid var(--color-accent-cyan);
  border-top: 4px solid transparent;
  border-radius: 50%;
  margin: 1rem auto 0 auto;
  animation: spin 1s linear infinite;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

/* =====================================
   SHORTCUT SYSTEM
   ===================================== */
.shortcut-container {
  position: fixed;
  bottom: var(--space-lg);
  left: 50%;
  transform: translateX(-50%);
  display: flex;
  gap: var(--space-lg);
  background: transparent;
  border: none;
  border-radius: 0.5rem;
  padding: 0.75rem 1rem;
  z-index: 1000;
}

.shortcut-container:hover {
  background: transparent;
}

.shortcut-item {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  font-family: var(--font-mono);
}

.shortcut-key {
  background: rgba(255, 255, 255, 0.05);
  color: var(--color-text-primary);
  padding: 0.25rem 0.5rem;
  border-radius: 0.25rem;
  font-family: var(--font-mono);
  font-size: 0.75rem;
  font-weight: 500;
  min-width: 20px;
  text-align: center;
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.2s ease;
}

.shortcut-key:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(255, 255, 255, 0.25);
}

.shortcut-plus {
  color: rgba(255, 255, 255, 0.4);
  font-size: 0.7rem;
  margin: 0 0.25rem;
}

.shortcut-label {
  color: var(--color-text-muted);
  font-size: 0.8rem;
  font-weight: 400;
}

/* KBD要素のスタイリング */
.kbd-key {
  background: rgba(255, 255, 255, 0.05);
  color: var(--color-text-primary);
  padding: 0.25rem 0.5rem;
  border-radius: 0.25rem;
  font-family: var(--font-mono);
  font-size: 0.75rem;
  font-weight: 500;
  min-width: 20px;
  text-align: center;
  border: 1px solid rgba(255, 255, 255, 0.15);
  display: inline-block;
  transition: all 0.2s ease;
}

.kbd-key:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(255, 255, 255, 0.25);
}

/* =====================================
   MODAL SYSTEM
   ===================================== */
.modal-overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.8);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 10000;
  backdrop-filter: blur(5px);
}

.modal-container {
  background: var(--gradient-dark);
  border: 2px solid var(--color-accent-cyan);
  border-radius: var(--border-radius-lg);
  padding: var(--space-2xl);
  max-width: 500px;
  width: 90%;
  box-shadow: var(--glow-cyan), 0 20px 60px rgba(0, 0, 0, 0.5);
  position: relative;
}

/* =====================================
   APP LAYOUT SYSTEM
   ===================================== */
.app-background {
  min-height: 100vh;
  width: 100%;
  position: relative;
  overflow: hidden;
}

.center-panel {
  width: 100%;
  height: 100vh;
  display: flex;
  flex-direction: column;
  overflow: hidden;
}

/* =====================================
   SCREEN LAYOUT SYSTEM
   ===================================== */
.screen-layout {
  width: 100%;
  height: 100vh;
  display: flex;
  flex-direction: column;
  overflow: hidden;
}

.content-area {
  flex: 1;
  display: flex;
  flex-direction: column;
  overflow: hidden;
}

/* 
   追加しました:
   - ゲーム画面用のクラス（game-screen, word-japanese, word-hiragana）
   - タイピング文字状態のクラス（typing-char, char-completed, char-current, char-pending, char-incorrect）
   - リザルト画面用のクラス（result-screen, result-title, stats-grid, stat-card, etc.）
   - ランキング画面用のクラス（ranking-screen, ranking-table, table-header-cell, etc.）
   - ショートカット表示用のクラス（shortcut-container, shortcut-item, shortcut-key, etc.）
   - モーダル用のクラス（modal-overlay, modal-container）
   - アニメーション（spin, countUp）
*/

/* =====================================
   MINIMAL SHORTCUT SYSTEM
   ===================================== */
.minimal-shortcut {
  position: fixed;
  bottom: var(--space-lg);
  right: var(--space-lg);
  display: flex;
  flex-direction: column;
  gap: var(--space-sm);
  background: rgba(26, 26, 26, 0.7);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 0.5rem;
  padding: 0.75rem;
  backdrop-filter: blur(10px);
  z-index: 1000;
  transition: all var(--transition-normal);
}

.minimal-shortcut:hover {
  background: rgba(26, 26, 26, 0.8);
  border-color: rgba(255, 255, 255, 0.15);
}

.minimal-shortcut.visible {
  opacity: 1;
  transform: translateY(0) translateZ(0);
}

.minimal-shortcut.hidden {
  opacity: 0;
  transform: translateY(15px) translateZ(0);
}

.minimal-shortcut .key {
  background: rgba(255, 255, 255, 0.05);
  color: var(--color-text-primary);
  padding: 0.2rem 0.4rem;
  border-radius: 0.25rem;
  font-family: var(--font-mono);
  font-size: 0.7rem;
  font-weight: 500;
  min-width: 18px;
  text-align: center;
  display: inline-block;
  border: 1px solid rgba(255, 255, 255, 0.15);
  transition: all 0.2s ease;
}

.minimal-shortcut .key:hover {
  background: rgba(255, 255, 255, 0.1);
  border-color: rgba(255, 255, 255, 0.25);
}

.minimal-shortcut .plus {
  color: rgba(255, 255, 255, 0.4);
  margin: 0 0.2rem;
  font-size: 0.6rem;
}

.minimal-shortcut .label {
  color: var(--color-text-muted);
  font-size: 0.7rem;
  margin-left: var(--space-xs);
  font-family: var(--font-mono);
  font-weight: 400;
}

/* ショートカットポータルコンテナのスタイル */
#shortcut-portal-container {
  background: transparent !important;
  border: none !important;
  backdrop-filter: none !important;
}

/* =====================================
   TYPING AREA PERFORMANCE OPTIMIZATIONS
   typingmania-ref流 GPU加速最適化
   ===================================== */

/* タイピングエリア - 超高速レンダリング最適化 */
.typing-area {
  /* GPU レイヤー強制生成 */
  transform: var(--performance-layer-force);
  will-change: var(--performance-will-change);
  contain: var(--performance-contain);
  content-visibility: var(--performance-content-visibility);
  
  /* レイアウト最適化 */
  display: flex;
  flex-wrap: wrap;
  gap: 0.125rem;
  
  /* フォント設定 */
  font-family: var(--font-mono);
  font-size: 1.75rem;
  line-height: 1.6;
  letter-spacing: 0.05em;
  
  /* 視覚的配置 */
  padding: var(--space-lg);
  background: var(--color-base-dark);
  border-radius: 12px;
  border: 1px solid var(--color-base-medium);
  
  /* スムーズトランジション */
  transition: box-shadow 0.2s ease;
}

.typing-area:focus-within {
  box-shadow: var(--glow-cyan);
  border-color: var(--color-accent-cyan);
}

/* タイピング文字 - 個別最適化 */
.typing-char {
  /* 超高速GPU描画 */
  transform: translateZ(0);
  will-change: background-color, color, transform;
  contain: layout style;
  
  /* 配置 */
  display: inline-block;
  position: relative;
  padding: 0.1em 0.2em;
  border-radius: 4px;
  
  /* トランジション最適化 */
  transition: all 0.15s cubic-bezier(0.4, 0, 0.2, 1);
  backface-visibility: hidden;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* 文字状態 - 直接DOM操作対応 */
.typing-char.char-pending {
  color: var(--color-text-muted);
  background: transparent;
  opacity: 0.7;
}

/* 🎯 現在文字フォーカス表示 - シンプル&高速 */
.typing-char.current {
  color: #000000;
  background: #ff9c00;
  border-radius: 4px;
  font-weight: 600;
  position: relative;
}

/* 🎯 現在文字にシンプルなカーソル効果 */
.typing-char.current::after {
  content: '';
  position: absolute;
  right: -1px;
  top: 0;
  bottom: 0;
  width: 1px;
  background: #000000;
  opacity: 0.7;
}

/* 🎯 完了文字 - OptimizedTypingArea用 */
.typing-char.completed {
  color: var(--color-success);
  background: rgba(129, 199, 132, 0.15);
  transform: translateZ(0);
  opacity: 0.9;
}

/* 🎯 未入力文字 - OptimizedTypingArea用 */
.typing-char.pending {
  color: var(--color-text-muted);
  background: transparent;
  opacity: 0.7;
}

.typing-char.char-completed {
  color: var(--color-success);
  background: rgba(129, 199, 132, 0.15);
  transform: translateZ(0);
  opacity: 0.9;
}

.typing-char.char-error {
  color: var(--color-error);
  background: rgba(242, 139, 130, 0.3);
  box-shadow: var(--glow-error);
  animation: shake 0.3s ease-in-out;
}

/* 🎯 シンプルなフォーカス表示（アニメーションなし） */
@keyframes typing-focus-pulse {
  0%, 100% { 
    opacity: 1;
  }
}

/* エラー時のシェイクアニメーション */
@keyframes shake {
  0%, 100% { transform: translateZ(0) translateX(0); }
  25% { transform: translateZ(0) translateX(-2px); }
  75% { transform: translateZ(0) translateX(2px); }
}

/* ゲーム画面 - パフォーマンス最適化 */
.game-screen {
  /* GPU加速レイヤー */
  transform: translateZ(0);
  will-change: transform, opacity;
  contain: layout style paint;
  
  /* レイアウト */
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: var(--space-lg);
  
  /* 視覚的配置 */
  min-height: 100vh;
  padding: var(--space-xl);
  background: var(--gradient-dark);
}

/* 単語表示 - 高速レンダリング */
.word-japanese,
.word-hiragana {
  transform: translateZ(0);
  will-change: transform, opacity;
  contain: layout style;
  
  text-align: center;
  font-family: var(--font-ui);
  font-weight: 600;
  color: var(--color-text-primary);
  text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
}

.word-japanese {
  font-size: 2.5rem;
  margin-bottom: var(--space-sm);
}

.word-hiragana {
  font-size: 1.5rem;
  color: var(--color-text-secondary);
  margin-bottom: var(--space-lg);
}

/* メディアクエリ - レスポンシブ最適化 */
@media (max-width: 768px) {
  .typing-area {
    font-size: 1.5rem;
    padding: var(--space-md);
  }
  
  .word-japanese {
    font-size: 2rem;
  }
  
  .word-hiragana {
    font-size: 1.25rem;
  }
}

@media (max-width: 480px) {
  .typing-area {
    font-size: 1.25rem;
    padding: var(--space-sm);
  }
  
  .word-japanese {
    font-size: 1.75rem;
  }
  
  .word-hiragana {
    font-size: 1rem;
  }
}

/* ハイコントラストモード対応 */
@media (prefers-contrast: high) {
  .typing-char.current {
    background: #ffff00 !important; /* 黄色でより高いコントラスト */
    color: #000000 !important;
    border: 3px solid #ff9c00 !important;
    box-shadow: 
      0 0 0 2px #000000,
      0 0 12px #ffff00 !important;
  }
  
  .typing-char.completed {
    background: var(--color-success) !important;
    color: var(--color-base-black) !important;
    border: 1px solid #000000;
  }
  
  .typing-char.pending {
    opacity: 1;
    color: var(--color-text-primary);
    border: 1px solid rgba(255, 255, 255, 0.3);
  }
}

/* リデュースモーション対応 */
@media (prefers-reduced-motion: reduce) {
  .typing-char {
    transition: none;
    animation: none !important;
  }
  
  .typing-char.current {
    /* シンプルなフォーカス表示 */
    color: #000000;
    background: #ff9c00;
    border-radius: 4px;
    font-weight: 600;
  }
}

/* フォーカス管理 - アクセシビリティ */
.typing-area:focus {
  outline: 2px solid var(--color-accent-cyan);
  outline-offset: 4px;
}

.typing-char:focus {
  outline: 1px solid var(--color-accent-cyan);
  outline-offset: 2px;
}

/* パフォーマンス監視用デバッグスタイル（開発時のみ） */
[data-performance-debug="true"] .typing-char {
  position: relative;
}

[data-performance-debug="true"] .typing-char::after {
  content: attr(data-state);
  position: absolute;
  top: -1.5em;
  left: 0;
  font-size: 0.7em;
  color: var(--color-text-muted);
  pointer-events: none;
}
